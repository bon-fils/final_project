<!DOCTYPE html>
<html>
<head>
    <title>Departments Debug Test</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
    <h1>Departments Management Debug Test</h1>

    <div id="results"></div>

    <script>
        function log(message) {
            $('#results').append('<p>' + new Date().toLocaleTimeString() + ': ' + message + '</p>');
        }

        function testStatistics() {
            log('Testing statistics...');
            $.get('manage-departments.php?ajax=1&action=get_statistics')
                .done(function(data) {
                    log('Statistics response: ' + JSON.stringify(data));
                })
                .fail(function(xhr, status, error) {
                    log('Statistics error: ' + status + ' - ' + error);
                    log('Response: ' + xhr.responseText);
                });
        }

        function testListDepartments() {
            log('Testing list departments...');
            $.get('manage-departments.php?ajax=1&action=list_departments')
                .done(function(data) {
                    log('Departments response: ' + data.length + ' departments found');
                })
                .fail(function(xhr, status, error) {
                    log('Departments error: ' + status + ' - ' + error);
                    log('Response: ' + xhr.responseText);
                });
        }

        // Test on page load
        $(document).ready(function() {
            log('Page loaded, starting tests...');
            setTimeout(testStatistics, 1000);
            setTimeout(testListDepartments, 2000);
        });
    </script>
</body>
</html>